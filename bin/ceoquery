#!/usr/bin/python
"""
ceoquery - a script to lookup member and account information
"""
import os, sys
from csc.adm import members, terms

try:
    members.connect()
except Exception, e:
    print "ceoquery: %s" % e
    sys.exit(1)

def usage():
    print "Usage: ceoquery memberlist|termusers"

if len(sys.argv) < 2:
    usage()

elif sys.argv[1] == 'memberlist':
    
    current_term = terms.current()
    members = members.list_term(current_term)
    for member in members.values():
        if 'program' in member:
            program = member['program'][0]
        else:
            program = ''
        print "%s|%s|%s" % (member['cn'][0], program, member['uid'][0])

elif sys.argv[1] == 'allmembers':

    pass

elif sys.argv[1] == 'booklist':

    pass

elif sys.argv[1] == 'allusers':

    pass

elif sys.argv[1] == 'termusers':

    if len(sys.argv) > 2:
        term = sys.argv[2]
    else:
        term = terms.current()

    members = members.list_term(term)
    for member in members:
        print member

else:

    usage()

