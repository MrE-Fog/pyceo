#!/usr/bin/python2.4 --
"""CEO SUID Python Wrapper Script"""
import os, sys

safe_environment = ['LOGNAME', 'USERNAME', 'USER', 'HOME', 'TERM', 'LANG'
    'LC_ALL', 'LC_COLLATE', 'LC_CTYPE', 'LC_MESSAGES', 'LC_MONETARY',
    'LC_NUMERIC', 'LC_TIME', 'UID', 'GID', 'SSH_CONNECTION', 'SSH_AUTH_SOCK',
    'SSH_CLIENT']

for key in os.environ.keys():
    if key not in safe_environment:
        del os.environ[key]

os.environ['LESSSECURE'] = '1'
os.environ['PATH'] = '/usr/sbin:/usr/bin:/sbin:/bin'

for pathent in sys.path[:]:
    if not pathent.find('/usr') == 0 and not pathent.find('/var') == 0:
        sys.path.remove(pathent)

euid = os.getuid()
egid = os.getgid()
try:
    os.setreuid(euid, euid)
    os.setregid(egid, egid)
except OSError, e:
    print str(e)
    sys.exit(1)

import csc.apps.urwid.main
csc.apps.urwid.main.start(euid, egid)
